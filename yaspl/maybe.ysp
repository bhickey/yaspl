(module maybe
  (import bool)
  (export maybe fromMaybe isJust)

  (data Maybe (v)
    (nothing)
    (just v))

  (defn maybe (d fn m)
    (All (a b) (b -> (a -> b) -> (Maybe a) -> b))
    (case m
      ((nothing) -> d)
      ((just v) -> (fn v))))

  (defn fromMaybe (d m)
    (All (v) (v -> (Maybe v) -> v))
    (case m
      ((nothing) -> m)
      ((just v) -> v)))

  (defn isJust (m)
    (All (v) ((Maybe v) -> v))
    (case m
      ((nothing) -> False)
      ((just _) -> True))))

